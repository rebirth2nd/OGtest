{% extends 'shop/base.html' %}

{% block containercontent %}
    <form id="myForm" action="/view_cart/" method='POST'>{% csrf_token %}
    <table class="table">
        <tr>
            <th>Product</th>
            <th>Quantity</th>
            <th>Total Price</th>
        </tr>
        {% for detail in carts %}
        <tr>
            <td>{{ detail.product.name }}</td>
            <td><input type="number" min='0' step='1' name='{{ detail.product.id }}' value='{{ detail.quantity }}'></td>
            <td class="pricetd">{{ detail.total_price }}</td>
        </tr>
        {% endfor %}
        <tr>
            <td></td>
            <td>Total Summary: </td>
            <td id='mySum'></td>
        </tr>
    </table>
    <button type="submit" class="btn btn-primary">Update</button>
    <button type="button" class="btn btn-primary" onclick="return goCheckOut();">Checkout</button>
    </form>
{% endblock %}

{% block bodyscriptadd %}
  <script>
  $(document).ready(function(){
     colSum();
  });

  function colSum() {
    var sum=0;
    //iterate through each input and add to sum
    $('.pricetd').each(function() {     
            sum += parseFloat($(this).text());                     
    }); 
    //change value of total
    $('#mySum').html(sum.toFixed(2));
  }

  function goCheckOut() {
    $('#myForm').append('<input type="hidden" name="checkout" value="1">').submit();
  }
  </script>
{% endblock %}
